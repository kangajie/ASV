<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="phc.png" type="image/png">
    <title>Garuda Layang</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
        }

        body {
            background: #000;
            overflow: hidden;
            -webkit-user-drag: none;
        }

        .video-wrapper {
            position: relative;
            width: 100vw;
            height: 100vh;
            padding-bottom: 0;
        }

        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            pointer-events: auto;
            z-index: 2;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .video-wrapper iframe.active {
            opacity: 1;
        }

        .poster-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
            opacity: 1;
            transition: opacity 0.5s ease-in-out;
        }

        .poster-image.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 3;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 30px;
            border-radius: 10px;
            display: none;
        }

        .loading-indicator.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="video-wrapper">
        <img 
            id="posterImage" 
            class="poster-image" 
            src="poster.jpg" 
            alt="Live Stream Poster"
            onerror="this.style.display='none'">
        
        <div id="loadingIndicator" class="loading-indicator">
            ðŸ”´ Menunggu Live Stream Dimulai...
        </div>
        
        <iframe
            id="youtubePlayer"
            src=""
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
            style="width:100vw;height:100vh;border:none;">
        </iframe>
    </div>

<script>
function extractVideoId(url) {
    if (!url) return null;
    url = url.trim();
    if (!url.includes('http') && !url.includes('youtube') && !url.includes('youtu.be') && !url.includes('/') && !url.includes('?')) {
        return url;
    }
    let videoId = null;
    const watchMatch = url.match(/[?&]v=([^&?#]+)/);
    if (watchMatch) {
        videoId = watchMatch[1];
    }
    const shortMatch = url.match(/youtu\.be\/([^?&#]+)/);
    if (shortMatch) {
        videoId = shortMatch[1];
    }
    const embedMatch = url.match(/embed\/([^?&#]+)/);
    if (embedMatch) {
        videoId = embedMatch[1];
    }
    const vMatch = url.match(/\/v\/([^?&#]+)/);
    if (vMatch) {
        videoId = vMatch[1];
    }
    const liveMatch = url.match(/\/live\/([^?&#]+)/);
    if (liveMatch) {
        videoId = liveMatch[1];
    }
    if (videoId) {
        videoId = videoId.split('&')[0].split('?')[0].split('#')[0].trim();
    }
    return videoId;
}

function loadYouTubeVideo(url, showPoster = false) {
    const videoId = extractVideoId(url);
    if (!videoId) {
        console.error('Video ID tidak ditemukan dari URL:', url);
        return;
    }
    
    const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&modestbranding=1&rel=0&showinfo=0&controls=1&playsinline=1&enablejsapi=1`;
    const iframe = document.getElementById('youtubePlayer');
    const poster = document.getElementById('posterImage');
    const loading = document.getElementById('loadingIndicator');
    
    if (showPoster) {
        // Tampilkan poster, JANGAN load iframe (biarkan src kosong)
        if (poster) {
            poster.classList.remove('hidden');
        }
        if (iframe) {
            iframe.src = ''; // Kosongkan src agar tidak load YouTube
            iframe.classList.remove('active');
        }
        if (loading) {
            loading.classList.add('show');
        }
    } else {
        // Tampilkan iframe YouTube, sembunyikan poster
        if (poster) {
            poster.classList.add('hidden');
        }
        if (iframe) {
            iframe.src = embedUrl; // Load YouTube embed
            iframe.classList.add('active');
        }
        if (loading) {
            loading.classList.remove('show');
        }
    }
}

function checkLiveStreamStatus(videoId) {
    return new Promise((resolve) => {
        fetch(`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${videoId}&format=json`)
            .then(response => response.json())
            .then(data => {
                resolve(true);
            })
            .catch(error => {
                resolve(false);
            });
    });
}

let checkInterval = null;

function startLiveStreamChecker(videoId) {
    if (checkInterval) {
        clearInterval(checkInterval);
    }
    
    checkInterval = setInterval(async () => {
        const isActive = await checkLiveStreamStatus(videoId);
        
        if (isActive) {
            // Live stream sudah aktif, load video
            const iframe = document.getElementById('youtubePlayer');
            const poster = document.getElementById('posterImage');
            const loading = document.getElementById('loadingIndicator');
            
            if (iframe) {
                // Load YouTube embed
                const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&modestbranding=1&rel=0&showinfo=0&controls=1&playsinline=1&enablejsapi=1`;
                iframe.src = embedUrl;
                iframe.classList.add('active');
                
                // Sembunyikan poster
                if (poster) {
                    poster.classList.add('hidden');
                }
                if (loading) {
                    loading.classList.remove('show');
                }
                
                // Stop checking setelah live stream aktif
                if (checkInterval) {
                    clearInterval(checkInterval);
                    checkInterval = null;
                }
            }
        }
    }, 10000);
}

// ID link dari YouTube
const DEFAULT_VIDEO_ID = 'GsbYSJHLpgk';
// Path ke poster image (ganti dengan path poster Anda)
const POSTER_IMAGE_PATH = 'poster.jpg'; // Ganti dengan nama file poster Anda

window.addEventListener('DOMContentLoaded', async function() {
    const iframe = document.getElementById('youtubePlayer');
    const poster = document.getElementById('posterImage');
    const urlParams = new URLSearchParams(window.location.search);
    const videoParam = urlParams.get('v') || urlParams.get('url') || urlParams.get('youtube');
    
    let videoId = null;
    let isLiveStream = false;
    
    if (videoParam) {
        videoId = extractVideoId(videoParam);
        isLiveStream = videoParam.includes('/live/') || videoParam.includes('live');
    } else {
        const hash = window.location.hash.substring(1);
        if (hash) {
            videoId = extractVideoId(hash);
            isLiveStream = hash.includes('/live/') || hash.includes('live');
        } else {
            if (DEFAULT_VIDEO_ID && DEFAULT_VIDEO_ID !== 'VIDEO_ID') {
                videoId = DEFAULT_VIDEO_ID;
                isLiveStream = true;
            } else {
                console.error('Silakan set DEFAULT_VIDEO_ID atau gunakan parameter ?v=VIDEO_ID');
                return;
            }
        }
    }
    
    if (!videoId) {
        console.error('Video ID tidak ditemukan');
        return;
    }
    
    if (poster) {
        poster.src = POSTER_IMAGE_PATH;
        // Pastikan poster visible saat pertama kali
        poster.classList.remove('hidden');
    }
    
    if (isLiveStream) {
        // Untuk live stream, tampilkan poster dulu
        loadYouTubeVideo(videoId, true);
        
        // Check apakah live stream sudah aktif
        const isActive = await checkLiveStreamStatus(videoId);
        
        if (isActive) {
            // Live stream sudah aktif, tampilkan video
            loadYouTubeVideo(videoId, false);
        } else {
            // Live stream belum aktif, tetap tampilkan poster dan mulai checker
            loadYouTubeVideo(videoId, true);
            startLiveStreamChecker(videoId);
        }
    } else {
        // Video biasa, langsung tampilkan
        loadYouTubeVideo(videoId, false);
    }
});

document.addEventListener('contextmenu', function (e) {
    e.preventDefault();
    return false;
});

document.addEventListener('mousedown', function (e) {
    if (e.button === 2) {
        e.preventDefault();
        return false;
    }
});

document.addEventListener('mouseup', function (e) {
    if (e.button === 2) {
        e.preventDefault();
        return false;
    }
});

document.addEventListener('selectstart', function (e) {
    e.preventDefault();
    return false;
});

document.addEventListener('dragstart', function (e) {
    e.preventDefault();
    return false;
});

document.addEventListener('keydown', function (e) {
    if (e.key === 'F12' || e.keyCode === 123) {
        e.preventDefault();
        return false;
    }
    if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.keyCode === 73)) {
        e.preventDefault();
        return false;
    }
    if (e.ctrlKey && e.shiftKey && (e.key === 'J' || e.keyCode === 74)) {
        e.preventDefault();
        return false;
    }
    if (e.ctrlKey && e.shiftKey && (e.key === 'C' || e.keyCode === 67)) {
        e.preventDefault();
        return false;
    }
    if (e.ctrlKey && (e.key === 'u' || e.key === 'U' || e.keyCode === 85)) {
        e.preventDefault();
        return false;
    }
    if (e.ctrlKey && (e.key === 's' || e.key === 'S' || e.keyCode === 83)) {
        e.preventDefault();
        return false;
    }
    if (e.ctrlKey && (e.key === 'p' || e.key === 'P' || e.keyCode === 80)) {
        e.preventDefault();
        return false;
    }
    if (e.ctrlKey && (e.key === 'a' || e.key === 'A' || e.keyCode === 65)) {
        e.preventDefault();
        return false;
    }
    if (e.ctrlKey && e.shiftKey && (e.key === 'P' || e.keyCode === 80)) {
        e.preventDefault();
        return false;
    }
    if (e.ctrlKey && e.shiftKey && (e.key === 'E' || e.keyCode === 69)) {
        e.preventDefault();
        return false;
    }
});

document.addEventListener('copy', function (e) {
    e.preventDefault();
    return false;
});

document.addEventListener('cut', function (e) {
    e.preventDefault();
    return false;
});

document.addEventListener('paste', function (e) {
    e.preventDefault();
    return false;
});

(function() {
    var noop = function() {};
    var methods = ['log', 'debug', 'info', 'warn', 'error', 'assert', 'dir', 'dirxml', 'group', 'groupEnd', 'time', 'timeEnd', 'count', 'trace', 'profile', 'profileEnd'];
    for (var i = 0; i < methods.length; i++) {
        console[methods[i]] = noop;
    }
})();

(function() {
    var devtools = {open: false, orientation: null};
    var element = new Image();
    Object.defineProperty(element, 'id', {
        get: function() {
            devtools.open = true;
            return '';
        }
    });
    setInterval(function() {
        devtools.open = false;
        console.log(element);
        if (devtools.open) {
            document.body.innerHTML = '';
            window.location.reload();
        }
    }, 500);
})();

window.addEventListener('load', function() {
    var iframe = document.querySelector('iframe');
    if (iframe) {
        iframe.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });
    }
});
</script>
</body>
</html>


